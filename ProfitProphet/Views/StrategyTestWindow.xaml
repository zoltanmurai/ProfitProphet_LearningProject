<Window x:Class="ProfitProphet.Views.StrategyTestWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:oxy="http://oxyplot.org/wpf"
        xmlns:local="clr-namespace:ProfitProphet.Views"
        mc:Ignorable="d"
        Title="Stratégia Tesztelő" 
        Height="700" Width="1000"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="260"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Border Grid.Column="0" Background="#252526" BorderBrush="#3E3E42" BorderThickness="0,0,1,0" Padding="15">
            <StackPanel>
                <TextBlock Text="Paraméterek" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,20"/>

                <TextBlock Text="Időszak Kezdete:" Foreground="Gray" Margin="0,5,0,5"/>
                <DatePicker SelectedDate="{Binding StartDate}" Margin="0,0,0,10"
                            Background="#3E3E42" Foreground="Black" BorderBrush="Gray"/>

                <TextBlock Text="Időszak Vége:" Foreground="Gray" Margin="0,5,0,5"/>
                <DatePicker SelectedDate="{Binding EndDate}" Margin="0,0,0,20"
                            Background="#3E3E42" Foreground="Black" BorderBrush="Gray"/>

                <Separator Background="#3E3E42" Margin="0,0,0,20"/>

                <TextBlock Text="CMF Periódus:" Foreground="Gray" Margin="0,5,0,5"/>
                <TextBox Text="{Binding CmfPeriod}" Padding="5" Background="#3E3E42" Foreground="White" BorderBrush="Gray"/>

                <TextBlock Text="CMF MA Periódus:" Foreground="Gray" Margin="0,15,0,5"/>
                <TextBox Text="{Binding CmfMaPeriod}" Padding="5" Background="#3E3E42" Foreground="White" BorderBrush="Gray"/>

                <TextBlock Text="Árfolyam MA (Trend):" Foreground="Gray" Margin="0,15,0,5"/>
                <TextBox Text="{Binding PriceMaPeriod}" Padding="5" Background="#3E3E42" Foreground="White" BorderBrush="Gray"/>

                <Button Command="{Binding RunCommand}" 
                        Content="FUTTATÁS" 
                        Height="40" 
                        Margin="0,30,0,0"
                        Background="#007ACC" 
                        Foreground="White"
                        FontWeight="Bold"
                        BorderThickness="0">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="3"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </StackPanel>
        </Border>

        <Grid Grid.Column="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="1.5*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="2*"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" Text="Tőke Görbe" Foreground="#CCCCCC" FontWeight="Bold" Margin="0,0,0,5"/>

            <Border Grid.Row="1" BorderBrush="#3E3E42" BorderThickness="1" CornerRadius="3" Background="#1E1E1E" Margin="0,0,0,15">
                <oxy:PlotView Model="{Binding EquityModel}" Background="Transparent"/>
            </Border>

            <StackPanel Grid.Row="2" Margin="0,0,0,20">
                <TextBlock Text="Eredmények" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Összes Profit:" Foreground="Gray" Margin="0,2"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Result.TotalProfitLoss, StringFormat=C2}" 
                               Foreground="{Binding Result.TotalProfitLoss, Converter={StaticResource BoolToVisibilityConverter}}" FontWeight="Bold"
                               TextElement.Foreground="#4CC638"/>
                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Kötések száma:" Foreground="Gray" Margin="0,2"/>
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Result.TradeCount}" Foreground="White"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Találati arány:" Foreground="Gray" Margin="0,2"/>
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Result.WinRate, StringFormat={}{0:P1}}" Foreground="White"/>

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Score:" Foreground="Gray" Margin="0,2"/>
                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Result.Score, StringFormat=N2}" Foreground="#FFA500" FontWeight="Bold"/>
                </Grid>
            </StackPanel>

            <TextBlock Grid.Row="3" Text="Kötéslista" Foreground="#CCCCCC" FontWeight="Bold" Margin="0,0,0,5"/>

            <DataGrid Grid.Row="4" 
                      ItemsSource="{Binding Result.Trades}" 
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True"
                      Background="#1E1E1E"
                      RowBackground="#252526"
                      AlternatingRowBackground="#2D2D30"
                      Foreground="White"
                      BorderBrush="#3E3E42"
                      HeadersVisibility="Column"
                      GridLinesVisibility="Horizontal"
                      HorizontalGridLinesBrush="#3E3E42">

                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#3E3E42"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="Padding" Value="5"/>
                        <Setter Property="BorderThickness" Value="0,0,1,1"/>
                        <Setter Property="BorderBrush" Value="#1E1E1E"/>
                    </Style>
                </DataGrid.Resources>

                <DataGrid.Columns>
                    <DataGridTextColumn Header="Dátum" Binding="{Binding EntryDate, StringFormat=yyyy-MM-dd}" Width="*"/>
                    <DataGridTextColumn Header="Vétel" Binding="{Binding EntryPrice, StringFormat=N2}" Width="*"/>
                    <DataGridTextColumn Header="Eladás" Binding="{Binding ExitPrice, StringFormat=N2}" Width="*"/>
                    <DataGridTextColumn Header="Profit" Binding="{Binding Profit, StringFormat=N2}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>

        </Grid>
    </Grid>
</Window>